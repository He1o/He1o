# 随机事件及其概率

## 1. 随机事件及其运算

- **随机现象**：在一定条件下，并不总是出现相同结果的现象。
- **随机试验**：可重复的随机现象。
- **基本结果 $\omega$**：随机现象的最简单的结果，它将是统计中抽样的基本单元，故又称样本点。
- **基本空间 $\Omega$**：随机现象所有基本结果的全体。
- **随机事件**：随机现象某些基本结果组成的集合，简称“事件”。

>抛硬币的结果就是一个随机现象，具有两个基本结果，正面和反面。随机现象所有基本结果的全体就称为这个随机现象的基本空间。在统计学中，基本结果 $\omega$ 是抽样的基本单元，故基本结果又称 **样本点**，基本空间又称 **样本空间** ，抛硬币的基本空间：
>$$\Omega_1=\{\omega_0,\omega_1\}=\{正面，反面\}$$

>掷一颗骰子，“出现6点”、“出现偶数点”、“出现点数不超过2”都是**随机事件**，可以用其基本空间 $\Omega =\{1,2,3,4,5,6\}$ 的某个子集表示，例如“出现偶数点”可以表示为：
>$$A=\{2,4,6\}$$

- **必然事件** 
- **不可能事件** 
- **事件的关系**
    - 事件的包含
    - 事件的相等
    - 事件的互不相容
- **事件的运算** ：事件的基本运算对立、并、交和差，与集合的四种运算余、并、交和差是完全一样的。
    - 对立事件：设 $A$ 为一个试验里的事件，则由不在 $A$ 中的一切基本结果组成的事件称为 $A$ 的对立事件，记为 $\overline{A}$。必然事件和不可能事件互为对立事件。
    - 事件 $A$ 和 $B$ 的并：由事件 $A$ 和 $B$中所有的基本结果组成的一个新事件，记作$A\bigcup B$
    - 事件 $A$ 和 $B$ 的交：由事件 $A$ 和 $B$中公共的的基本结果组成的一个新事件，记作$A\bigcap B$ 或者 $AB$
    - 事件 $A$ 对 $B$ 的差：由在事件 $A$ 而不在事件 $B$ 中的基本结果组成的一个新事件，记作$A-B$。$A-B=A-AB=A\overline{B}$

## 2. 事件的概率

### 2.1 事件的概率
随机事件的发生是带有偶然性的。但随机事件发生的可能性还是有大小之别的，是可以设法度量的。例如抛硬币正反面的可能性都是$1/2$，用一个 $0$ 到 $1$ 的数来表示一个随机事件发生的可能性大小。概率论中，这种比率就是概率的原形。

**定义1** 在一个随机现象中，用来表示任一个随机事件 $A$ 发生可能性大小的实数（即比率）成为该事件的概率，记为 $P(A)$，并规定
1. 非负性公理：对任一事件 $A$，必有 $P(A)\ge 0$
2. 正则性公理：必然事件的概率 $P(\Omega)=1$
3. 可加性公理：若 $A_1$ 与 $A_2$ 是两个互不相容事件（即$A_1A_2=\emptyset$），则有 $P(A_1\bigcup A_2)=P(A_1)+P(A_2)$

这就是概率的公理化定义，它虽然刻划了概率的本质，但没有告诉人们如何去确定概率。历史上概率的古典定义、概率的统计定义和概率的主观定义都有各自确定概率的方法，在有了公理化定义之后，把它们看作确定概率的三种方法是很恰当的。

### 2.2 排列与组合
排列和组合是两类计数公式，基于如下两条计数原理：
- **乘法原理**
- **加法原理**

乘法原理，某件事需要 $k$ 个步骤，则每个步骤能选择的方法数量相乘就是总的可选择方法。加法原理，就是某件事由 $k$ 类方法可以完成，那么总的可选择方法就是这几类方法相加。
- **排列**　从 $n$ 个不同元素中任取 $r(r\le n)$ 个元素排成一列称为一个排列，按乘法原理，此种排列共有 $n\times (n-1)\times \cdots \times(n-r+1)$ 个，记为 $P^r_n$。若 $r=n$，称为全排列，全排列数共有 $n!$ 个，记为 $P_n$。
- **重复排列**　从 $n$ 个不同元素中每次取出一个，放回后再取下一个，如此连续取 $r$ 次所得的排列称为重复排列，此种重复排列数共有 $n^r$ 个。这里 $r$ 允许大于 $n$。
- **组合**　从 $n$ 个不同元素中任取 $r(r\le n)$ 个元素并成一组（不考虑其间顺序）称为一个组合，按乘法原理，此种组合总数为
$$\dbinom{n}{r}=\frac{P_n^r}{r!}=\frac{n\times (n-1)\times \cdots \times(n-r+1)}{r!}=\frac{n!}{r!(n-r)!}$$
并规定 $0!=1$ 和 $\dbinom{n}{r}=1$，同时 $\dbinom{n}{r}=1$ 还是二项式展开式的系数，即
$$(a+b)^n=\sum^n_{r=0}\dbinom{n}{r}a^rb^{n-r}$$
若在上式中令 $a=b=1$ ，可得一重要组合恒等式：
$$\dbinom{n}{0}+\dbinom{n}{1}+\cdots+\dbinom{n}{n}=2^n$$
- **重复组合**　从 $n$ 个不同元素每次取出一个，放回后再取下一个，如此连续取 $r$ 次所得的组合称为重复组合。重复组合总数为 $\dbinom{n+r-1}{r}$。

### 2.3 古典方法
古典方法是在经验事实的基础上对被考察事件发生可能性进行符合逻辑分析后得出该事件的概率。这种方法简单、直观、不需要做试验，但只能在一类特定的随机现象中使用。基本思想如下：
- 所涉及的随机现象只有有限个基本结果
- 每个基本结果出现的可能性是相同的（等可能性）
- 假如被考察的事件 $A$ 含有 $k$ 个基本结果，则事件 $A$ 的概率就是
$$P(A)=\frac{k}{n}=\frac{A中含基本结果的个数}{\Omega中基本结果总数}$$

下面以扑克游戏为例，计算每种牌型的概率。一副标准的扑克牌由52张组成，有两种颜色、四种花式和13种牌型，假设每张牌被抽出的可能性是相同的。下面来研究一些事件的概率。
1. 事件 $A=$ “抽五张牌，恰好是同花顺”。在抽五张牌的试验中，共有 $\dbinom{52}{5}$ 个等可能基本结果，事件 $A$ 包含的基本结果总数为 $10\times 4$。故事件 $A=$ 的概率为
$$P(A)=\frac{10\times 4}{\dbinom{52}{5}}=\frac{40}{2598960}=0.00001539$$  
    发生概率10万分之1.5
2. 事件 $B=$ “抽五张牌，四张牌型一样”。事件 $B$ 包含的基本结果总数为 $13\times 48$。故事件 $B=$ 的概率为
$$P(B)=\frac{624}{\dbinom{52}{5}}=\frac{624}{2598960}=0.00024$$
    发生的概率是万分之二，平均4167次才会发生一次。
3. 事件 $C=$ “抽五张牌，恰好是葫芦”。事件 $C$ 包含的基本结果总数为 $13\times \dbinom{4}{3}\times 12 \times\dbinom{4}{2}=3744$
$$P(C)=\frac{3744}{\dbinom{52}{5}}=\frac{3744}{2598960}=0.00144=\frac{1}{694}$$
4. 事件 $D=$ “抽五张牌，恰好是同花，但不是顺子”。事件 $D$ 包含的基本结果总数为 $\dbinom{13}{5}\times 4 - 40=5108$
$$P(D)=\frac{5108}{\dbinom{52}{5}}=\frac{5108}{2598960}=0.0019654=\frac{1}{508}$$
5. 事件 $E=$ “抽五张牌，恰好是顺子，但不是同花”。一共有十种顺子，每种顺子按照花色的不同共有 $4^5-4$ 种结果。因此，事件 $E$ 包含的基本结果总数为 $10\times (4^5-4)=10200$
$$P(E)=\frac{10200}{\dbinom{52}{5}}=\frac{10200}{2598960}=0.003924=\frac{1}{254}$$
6. 事件 $F=$ “抽五张牌，恰好是三条，但不是葫芦”。事件 $F$ 包含的基本结果总数为 $13\times \dbinom{4}{3}\times \dbinom{48}{2} - 3744=54912$
$$P(F)=\frac{54912}{\dbinom{52}{5}}=\frac{54912}{2598960}=0.021128=\frac{1}{47}$$
7. 事件 $G=$ “抽五张牌，恰好是两对”。事件 $F$ 包含的基本结果总数为 $\dbinom{4}{2}\times \dbinom{4}{2}\times \dbinom{13}{2}\times \dbinom{11}{1}\times 4=123552$
$$P(F)=\frac{54912}{\dbinom{52}{5}}=\frac{54912}{2598960}=0.04753=\frac{1}{21}$$
8. 事件 $H=$ “抽五张牌，恰好有一对”。事件 $F$ 包含的基本结果总数为 $\dbinom{4}{2}\times \dbinom{13}{1}\times \dbinom{12}{3}\times 4^3=1098240$
$$P(F)=\frac{1098240}{\dbinom{52}{5}}=\frac{1098240}{2598960}=0.42256=\frac{1}{2}$$

### 2.3 频率方法
频率方法是在大量重复试验中用频率去获取概率近似值的一个方法。它是最常用，也是最基本获得概率的方法。基本思想如下：
- 与考察事件 $A$ 有关的随机现象是允许进行大量重复试验的。
- 假如在 $N$ 次重复试验中，事件 $A$ 发生 $K_N$ 次，则事件 $A$ 发生的频率为
$$P^*_N(A)=\frac{K_N}{N}=\frac{事件A发生的次数}{重复试验次数}$$
- 频率 $P^*_N(A)$ 依赖于重复次数 $N$。随着重复次数 $N$ 的增加，频率 $P^*_N(A)$ 会稳定在某一常数附近，这个频率的稳定值已与 $N$ 无关，就是事件 $A$ 发生的概率。在现实世界中，我们无法将一个试验无限次的重复下去，在重复次数 $N$ 较大时，频率 $P^*_N(A)$ 就很接近概率 $P(A)$ 。在统计学中把频率称为概率的估计值，实际频率当作概率近似值使用。

### 2.4 主观方法
统计学中有一个贝叶斯学派，他们在研究随机现象之后认为，**一个事件的概率是人们根据经验对该事件发生可能性所给出的个人信念**。这样给出的概率就称为主观概率。

以经验为基础的主观概率和纯主观还是不同的。主观概率要求当事人对所考察的事件有较为透彻的了解和经验，并能对周围信息和历史信息进行仔细分析，在这个基础上确定的主观概率就能符合实际。

主观概率在遇到随机现象不能大量重复、无法用频率方法确定事件概率时就变得极为有用，因此在经济领域和决策分析中使用较为广泛。在某种意义上看，主观概率至少是频率方法和古典方法的一种补充，有了主观概率至少使人们在频率观点不适用时也能谈论概率，使用概率与统计方法。

## 3. 概率的性质
一些概率的常用性质
- 定理1　$P(\overline{A})=1-P(A)$
- 定理2　$P(\phi)=0$
- 定理3　对 $n$ 个互不相容事件 $A_1,\cdots,A_n$，有
$$P(\bigcap\limits^n_{i=1} A_i)=\sum^n_{i=1}P(A_i)$$
- 定理4　对任意两个事件 $A$ 和 $B$，若$A\supset B$，则
    - $P(A-B)=P(A)-P(B)$
    - $P(A)\le P(B)$
- 定理5　对任一事件 $A$，总有 $0\le P(A)\le 1$
- 定理6　对任意两个事件 $A$ 与 $B$，有
    - $P(A\bigcup B)=P(A)+P(B)-P(AB)$
    - $P(A\bigcup B)\le P(A)+P(B)$
- 定理7　对任意三个事件 $A,B,C$，有
    - $P(A\bigcup B \bigcup C)=P(A)+P(B)+P(C)-P(AB)-P(AC)-P(BC)+P(ABC)$
    - $P(A\bigcup B \bigcup C)\le P(A)+P(B)+P(C)$
  

## 4. 独立性
### 4.1 事件的独立性

- 定义1　对任意两个事件 $A$ 和 $B$，若有 $P(AB)=P(A)P(B)$，则称事件 $A$ 与 $B$ 相互独立，简称 $A$ 与 $B$ 独立。否则称事件 $A$ 与 $B$ 不独立。

两个事件的独立性是指一个事件的发生不影响另一个事件的发生。在概率角度讲，两个事件之间的独立性与这两个事件同时发生的概率有密切关系，即两独立事件同时发生的概率等于它们各自概率的乘积。

投掷两个骰子，两个骰子的点数是互不影响的，显然任何两个分别与两个骰子相关的事件都是独立的，例如事件 $A=$ “第一颗骰子出现1点”、事件 $B=$ “第二颗骰子出现偶数点”。

但是，两事件是否具有独立性并不总是显然的。例如同样两个事件 $A=$ “家中男女孩都有”、事件 $B=$ “家里至多一个女孩”。在家中有三个小孩的情况下，这两个事件是独立的。但是，家中有两个或四个小孩时，就不再独立了。

- 定理1　若事件 $A$ 和 $B$独立，则事件 $A$ 和 $\overline{B}$ 独立；$\overline A$ 和 $B$ 独立；$\overline A$ 和 $\overline{B}$ 独立。
  
证：由事件的运算性质知
$$A\overline{B}=A(1-B)=A-AB$$
其中 $A\supset AB$，再由 $A$ 和 $B$ 的独立性
$$
\begin{aligned}
    P(A\overline{B})&= P(A)-P(AB)\\
    &= P(A)-P(A)P(B)\\
    &= P(A)[1-P(B)]\\
    &= P(A)P(\overline{B})\\
\end{aligned}
$$

### 4.1 试验的独立性
利用事件的独立性可以定义两个或更多个试验的独立性。假设有两个试验 $E_1$ 和 $E_2$，假如试验 $E_1$ 的任一个结果与试验 $E_2$ 的任一个结果都是相互独立事件，则称这两个试验相互独立。类似的如果 $n$ 个试验相互间的任一结果之间都是相互独立的事件，则这些试验都相互独立。如果这 $n$ 个试验还是相同的，则称其为 $n$ 重独立重复试验。

$n$ 重伯努利试验是一类常见的随机模型。

**伯努利试验**　只有两个结果的实验就称为伯努利试验，例如抛硬币（正面和反面）、检查一个产品（合格与不合格）等等。在一次伯努利试验中，设成功的概率为 $p$，即
$$P(A)=p,P(\overline{A})=1-p$$

**$n$ 重伯努利试验**　由 $n$ 个（次）相同的、独立的伯努利试验组成的随机试验称为 $n$ 重伯努利试验。伯努利试验基本结果可用长为 $n$ 的序列表示，例如$AA\overline{A}AA$ 表示第三次失败，其余四次成功。在 $n$ 重伯努利试验中，在人们最关心的是成功次数。因为成功次数是基本结果中所含的最重要信息，而 $A$ 与 $\overline{A}$ 的排列次序在实际中往往是不感兴趣的信息。记
$$B_{n,k}=“n重伯努利试验中A出现k次”$$
一般概率公式为
$$P(B_{n,k})=\dbinom{n}{k}p^k(1-p)^{n-k}$$

## 5. 条件概率

### 5.1 条件概率
假设苹果有两个属性，一个是好看，一个是好吃。现对25个苹果进行统计，得到结果如下

| | $B:$好看 | $\overline{B}:$不好看 ||
| :----: | :------: | :----:| :----:|
|       $A:$好吃        |  10  |         5         |15|
| $\overline{A}:$不好吃 |  8  |         2          |10|
| |  18  |         7          |25|

思考问题，当事件 $B$ 发生后，事件 $A$ 再发生的概率是多少？由于事件 $B$ 发生了，给人们带来新的信息，即 $\overline{B}$ 不可能再发生了，所有可能发生的基本结果局限在 $B$ 的 $18$ 个结果，这时事件 $A$ 所包含的基本结果在 $\Omega_B$ 中所占的比率为 $10/18$，这就是在事件 $B$ 已经发生的情况下，事件 $A$ 的条件概率，即 $P(A|B)=10/18$。

条件概率 $P(A|B)=10/18$ 中分母是事件 $B$ 中的基本结果数，记为 $N(B)=18$。分子是事件 $A$ 和 $B$ 同时发生的基本结果数，即交事件 $AB$，记为记为 $N(AB)=10$。分子分母同时除以原基本空间 $\Omega$ 中的基本结果数 $N(\Omega)=25$，得到如下关系式
$$P(A|B)=\frac{N(AB)}{N(B)}=\frac{N(AB)/N(\Omega)}{N(B)/N(\Omega)}=\frac{P(AB)}{P(B)}$$
这表明条件概率可用两个特定的无条件概率之商表示，我们可以进一步得到条件概率的一般定义。

**定义1**　设 $A$ 与 $B$ 是基本空间 $\Omega$ 中的两个事件，且$P(B)>0$，在事件 $B$ 已发生的条件下，事件 $A$ 的条件概率 $P(A|B)$ 定义为 $P(AB)/P(B)$，即
$$P(A|B)=\frac{P(AB)}{P(B)}$$
其中 $P(A|B)$ 也称为给定事件 $B$ 下事件 $A$ 的条件概率。

条件概率满足概率的三条公理，非负、正则、可加。当 $B=\Omega$ 时，条件概率转化为无条件概率，因此把无条件概率看作特殊场合下的条件概率也未尝不可。

除此之外，条件概率还有一些特殊性质。

**定理1(乘法公式)**　对任意两个事件 $A$ 和 $B$，有
$$P(AB)=P(A|B)P(B)=P(B|A)P(A)$$
对两个等式，分别要求 $P(B)>0$ 和  $P(A)>0$。这个定理表明任意两个事件交的概率等于一事件的概率乘以在这时间已发生的条件下另一事件的条件概率，只要它们的概率都不为零。

**定理2**　假如事件 $A$ 与 $B$ 独立，且 $P(B)>0$，则 $P(A|B)=P(A)$，反之亦然。<br>
这个性质表明，若两事件独立，则其条件概率就等于其概率，这里事件 $B$ 的发生对事件 $A$ 是否发生没有任何影响，反之，若有 $P(A|B)=P(A)$，则有乘法公式可以得出 $P(AB)=P(A)P(B)$，故 $A$ 与 $B$ 独立。

**定理3(一般乘法公式)**　对任意三个事件 $A_1$、$A_2$、$A_3$，有
$$P(A_1A_2A_3)=P(A_1)P(A_2|A_1)P(A_3|A_1A_2)$$
其中 $P(A_1A_2)>0$。

### 5.2 全概率公式
全概率公式是概率论中的一个基本公式。它可以使一个复杂事件的概率计算化繁就简，得以解决。

**定理4**　设 $A$ 与 $B$ 是任意两个事件，假如 $0<P(B)<1$，则
$$P(A)=P(A|B)P(B)+P(A|\overline{B})P(\overline{B})$$
证：由 $B\bigcup \overline{B}=\Omega$ 和事件运算性质可知
$$A=A\Omega=A(B\bigcup \overline{B})=AB\bigcup A\overline{B}$$
显然 $AB$ 与 $A\overline{B}$ 是互不相容事件，由加法公式和乘法公式得
$$
\begin{aligned}
    P(A)&= P(AB)+P(A\overline{B})\\
    &= P(A|B)P(B)+P(A\overline{B})P(\overline{B})\\
\end{aligned}
$$
由于 $P(B)$ 不为0与1，所有 $P(\overline{B})>0$，从而上述两个条件概率 $P(A|B)$ 与 $P(A|\overline{B})$ 都是有意义的。

将上述全概率公式推广到一般形式，需要一个“分割”的概念。简而言之，两个互为对立的事件组成全集，当多个事件彼此之间没有交集且组成全集的时候，它们就是一个分割。

**定义2**　把基本空间 $\Omega$ 分成 $n$ 个事件 $B_1,B_2,\cdots,B_n$，假如满足如下条件
- $P(B_i)>0,i=1,2,\cdots,n$
- $B_1,B_2,\cdots,B_n$ 互不相容
- $\bigcap\limits^n_{i=1} B_i=\Omega$
则称事件组 $B_1,B_2,\cdots,B_n$ 为基本空间 $\Omega$ 的一个分割。

**定理5**　 设 $B_1,B_2,\cdots,B_n$ 是基本空间 $\Omega$ 的一个分割，则对 $\Omega$ 中任一事件 $A$，有
$$P(A)=\sum_{i=1}^nP(A|B_i)P(B_i)$$

由全概率公式可以推出一个很著名的公式。

**定理6(贝叶斯公式)**　设 $B_1,B_2,\cdots,B_n$ 是基本空间 $\Omega$ 的一个分割，且它们各自概率 $P(B_1),P(B_2),\cdots,P(B_n)$ 皆已知且为正，又设 $A$ 是 $\Omega$ 中的一个事件，$P(A)>0$，且在诸 $B_i$ 下事件 $A$ 的条件概率 $P(A|B_1),P(A|B_2),\cdots,P(A|B_n)$ 可通过试验等手段获得，则再 $A$ 给定下，事件 $B_k$ 的条件概率为
$$P(B_k|A)=\frac{P(A|B_k)P(B_k)}{\sum\limits^n_{i=1}P(A|B_i)P(B_i)},k=1,2,\cdots,n$$

